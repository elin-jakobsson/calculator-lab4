<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
  <meta charset="utf-8">
  <title>Minir√§knare</title>

  <style>
    html * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      width: 100%;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      align-content: center;
    }

    button {
      width: 22%;
      padding: 10px;
      margin-bottom: 10px;
      border: none;

      border-radius: 5px;
    }

    .num {
      background-color: #f4f4f4;
    }

    .equal {
      background-color: powderblue;
    }

    input {
      height: 3rem;
      padding: 5px;
      font-size: 1.5rem;
      width: 100%;
    }

    .rootDiv {
      margin: 0.5rem;
      width: 500px;
      min-width: 235px;
    }

    .buttonContainer {
      margin-top: 10px;
      width: 100%;
    }

    .buttonContainer>div {
      width: 100%;
      display: flex;
      justify-content: space-between;
    }
  </style>


  <script src="https://cdn.jsdelivr.net/npm/vue"></script>
  <script>
    window.addEventListener('load', () => {

      new Vue({
        el: '#root',
        data: {
          history: '',
          inputValue: '',
          inputPlaceholder: '',
          currentValue: '',
          minusSign: 0,
          dotSign: 0

          // plusButton: '+'


        }, // data

        methods: {
          validateNum: function(evt) {;
            evt = (evt) ? evt : window.event;
            let charCode = (evt.which) ? evt.which : evt.keyCode;
            /* Use either which or keyCode, depending on browser support,
            here we chech wich one of them that is true*/

            // if input is emty enable minusSign again
            // this only works if the input type is text, cant count length with type number
            if (this.minusSign === 1 && this.inputValue == '') {
              this.minusSign = 0;
            }

            if (this.dotSign === 1 && this.inputValue.indexOf(".") === -1) {
              this.dotSign = 0;
            }

            // validate which buttons that should work or not
            if (charCode > 47 && charCode < 58 || charCode === 45 || charCode === 46) {
              if (this.minusSign === 0 && this.inputValue == '' && charCode === 45 && this.history.endsWith("-") !== true) { // The minus (-) sign should only be possible as a first character
                this.minusSign = 1;
                return true;
              } else if (this.dotSign === 0 && this.inputValue.indexOf(".") === -1 && this.inputValue !== '' && charCode === 46) {
                if (this.inputValue.indexOf('-') === 0 && this.inputValue.length === 1) { // The dot (.) sign should only be possible as a second character
                  evt.preventDefault();
                } else {
                  this.dotSign = 1;
                  return true;
                }
              } else if (charCode > 47 && charCode < 58) {
                console.log('true key ', charCode);
                return true;
              } else {
                evt.preventDefault();
                console.log('false key ', charCode);
              }
            } else {
              console.log('false key ', charCode);
              evt.preventDefault();
            }
          }, // validateNum

          minusButton: function() {
            if (this.minusSign === 1 && this.inputValue == '') {
              this.dotSign = 0;

            }
            if (this.minusSign === 0 && this.inputValue == '' &&
                this.history.endsWith("-") !== true &&
                this.history.endsWith("+") !== true &&
                this.history.endsWith("/") !== true &&
                this.history.endsWith("*") !== true) {
              this.minusSign = 1;
              this.inputValue += '-';
            }

            if (this.inputValue.length > 0 && this.inputValue.indexOf("-") === -1 || this.inputValue.indexOf("-") === 0 && this.inputValue.length > 1) {
              this.history += this.inputValue + '-';
              let get = this.history.substring(0, this.history.length - 1)
              let count = eval(get); //The eval() function evaluates or executes an argument. works on strings and make shore that the string comes from a trusted source.
              console.log(this.history);
              console.log(get);
              this.inputValue = '',
                this.inputPlaceholder = count;
            }

          }, // minusButton
          dotButton: function() {
            if (this.dotSign === 1 && this.inputValue.indexOf(".") === -1) {
              this.dotSign = 0;
            }
            if (this.dotSign === 0 && this.inputValue.indexOf(".") === -1 && this.inputValue !== '') {
              if (this.inputValue.indexOf('-') === 0 && this.inputValue.length === 1) {

              } else {
                this.dotSign = 1;
                this.inputValue += '.';
              }
            }
          }, // dotButton
          clear: function() {
            this.history = "";
            this.inputValue = "";
            this.inputPlaceholder = '';
            this.currentValue = '';
          },

          plusButton: function(sign) {
            //console.log(this.inputValue);
            if (this.inputValue !== '') {
              if (this.inputValue.indexOf('-') === 0 && this.inputValue.length === 1) {

                console.log('must be a number');
              } else {

                if (sign === '/' || sign === '*') {
                  this.history += this.inputValue + sign;
                  // this.currentValue += this.inputValue;
                  this.currentValue = this.history.substring(0, this.history.length - 1);

                  console.log('current ',this.currentValue);

                  let secondCount = eval(this.currentValue);


                  this.inputValue = '',
                  console.log('what I get ',this.currentValue);
                  this.inputPlaceholder = secondCount;
                  this.currentValue = secondCount;
                  // this.inputPlaceholder = '';

                }else if (sign === '+' || sign === '-'){
                  this.history += this.inputValue + sign;

                  // this.currentValue += this.inputValue;

                  // this.inputPlaceholder = '';


                  let get = this.history.substring(0, this.history.length - 1)
                  let count = eval(get);
                  console.log(this.history);
                  console.log(get);
                  console.log(count);

                  this.inputValue = '',
                  this.inputPlaceholder = count;
                  this.currentValue = count;
                  console.log(this.currentValue);
                }

              }

            } else {
              console.log('no value');
            }
          },
          equals: function(event) {

            if (true) {

            }

            console.log(event.type);
            //this.inputValue = split('+')
            //  this.inputValue = Number(this.inputValue);
            console.log(this.inputValue);
            console.log(typeof this.inputValue);
          }
        } // Methods
      }); // Vue


    }); // window load
  </script>
</head>

<body>
  <div class="rootDiv" id="root">
    <p>{{history}}</p> <br>
    <input v-model='inputValue' @keypress="validateNum(event)" :placeholder="inputPlaceholder" type="text" name="" :value="inputValue">

    <div class="buttonContainer">
      <div class="row1">
        <button type="button" name="button">&times;&#178;</button>
        <button type="button" name="button">&#8730;</button>
        <button type="button" name="button">&#8678;</button>
        <button @click='clear' type="button" name="button">Clear</button>
      </div>
      <div class="row2">
        <button @click='inputValue += "1"' class="num" type="button" name="button">1</button>
        <button @click='inputValue += "2"' class="num" type="button" name="button">2</button>
        <button @click='inputValue += "3"' class="num" type="button" name="button">3</button>
        <button @click='plusButton("/")' type="button" name="button">&#247;</button>
      </div>
      <div class="row3">
        <button @click='inputValue += "4"' class="num" type="button" name="button">4</button>
        <button @click='inputValue += "5"' class="num" type="button" name="button">5</button>
        <button @click='inputValue += "6"' class="num" type="button" name="button">6</button>
        <button @click='minusButton' type="button" name="button">&#8722;</button>
      </div>
      <div class="row4">
        <button @click='inputValue += "7"' class="num" type="button" name="button">7</button>
        <button @click='inputValue += "8"' class="num" type="button" name="button">8</button>
        <button @click='inputValue += "9"' class="num" type="button" name="button">9</button>
        <button @click='plusButton("*")' type="button" name="button">&#215;</button>
      </div>
      <div class="row4">
        <button @click='dotButton' type="button" name="button">.</button>
        <button @click='inputValue += "0"' class="num" type="button" name="button">0</button>
        <button @click='equals' class="equal" type="button" name="button">&#61;</button>
        <button @click='plusButton("+")' type="button" name="button">&#43;</button>
      </div>

    </div>

    <!-- <button type="button" name="button">x^2</button>
      <button type="button" name="button">root</button>
      <br>
      <button type="button" name="button">clear</button>
      <button type="button" name="button">=</button> -->


  </div>

</body>

</html>
